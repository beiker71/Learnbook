if(typeof console=="undefined"||typeof console.log=="undefined"){var console={log:function(){}}}var quizCount=0;var quiz,qScore,qMax,qType,btnImg,countscore;var unfinQz="";var gNoScoreQuizMsg=((typeof window.recommendedMsg=="undefined")?"recommended":window.recommendedMsg);var gRequiredMsg=((typeof window.requiredMsg=="undefined")?"required":window.requiredMsg);var interactionsQuizzes;function chooseBtn(){btnImg=("nextModule");return btnImg}function closeIfLastSCO(){if(typeof top.API_extensions!="undefined"){var a=top.API_extensions.gSCOCourseStructure;if(top.API_extensions.gSCOCourseStructure.getNextSCO()!=null&&a.getNextSCO().index>0){a.changeSCOContent(a.getNextSCO(),parent.frames[0])}else{top.window.close()}}else{}}function setupQuizzes(){interactionsQuizzes=false;for(var e=0;e<PageArray.length;e++){var f=PageArray[e];if(typeof f.quiz!="undefined"){quizCount++;qType=(typeof f.type!="undefined")?f.type:"Q";if(qType=="I"){interactionsQuizzes=true;if(testing){console.log("interactionsQuizzes="+interactionsQuizzes)}}var c=(qType+f.quiz);if(testing){console.log("in setupQuizes objectiveID="+c)}var a=(parent.SCOGetObjectiveData(c,"status"))?(parent.SCOGetObjectiveData(c,"status")):"";var b=(parent.SCOGetObjectiveData(c,"score.max"))?(parent.SCOGetObjectiveData(c,"score.max")):"";var d=(parent.SCOGetObjectiveData(c,"score.raw"))?(parent.SCOGetObjectiveData(c,"score.raw")):"";if(typeof d!="undefined"){f.qScore=parseInt(d,10)}qScore=f.qScore;if((b!="")&&(typeof b!="undefined")&&!isNaN(b)){f.qMax=parseInt(b,10)}qMax=f.qMax;if(testing){console.log("from quizFunctions.js: setupQuizzes");console.log((e+1)+": "+c+", objMax= "+b+", objScore= "+d);console.log("qMax="+qMax+", qScore="+qScore+"qType"+qType)}}}if(interactionsQuizzes){loadInteractions()}}function wait(){}function showProgressMsg(){var a=parent.myStage.document.getElementById("quizProgress");a.style.display="block";if(!a.style.top>0){a.style.display="block"}else{}}function turnOnMsg(){parent.myStage.document.getElementById("loadingMsg").style.display="block"}function turnOffMsg(){parent.myStage.document.getElementById("loadingMsg").style.display="none"}function scoreQuizzes(){var c=parent.myStage.document.getElementById("quizProgress");var f=parent.myStage.document.getElementById("quizMessages");if(parent.APIOK()){btnImg=chooseBtn();c.style.display="block";moduleStatus="";var p=parent.myStage.document.createElement("div");var e="Loading data, please wait!<br><img src='images/ajax-loader-3.gif'/>";parent.myStage.document.getElementById("NavBar").appendChild(p);p.id="loadingMsg";p.className="loadingMsg";parent.myStage.document.getElementById("loadingMsg").innerHTML=(e);turnOnMsg();var a=parseInt(parent.SCOGetValue("cmi.student_data.mastery_score"),10);var m=0;var o=0;var k=0;var h="";if(testing){console.log("In scoreQuizzes: iMasteryScore= "+a+", moduleStatus= "+moduleStatus);console.log("totalmaxRawScore= "+m+", totalRawScore= "+o+", totalPercentScore= "+k)}if(testing){console.log("moduleStatus="+moduleStatus)}for(var n=0;n<PageArray.length;n++){var l=PageArray[n];if(l.quiz){var d=l.type?l.type:"Q";var g=(d+l.quiz);var b=l.rm?l.rm:"";var r;countscore=((typeof l.countscore!="undefined")&&(l.countscore>=0))?l.countscore:"1";if(countscore==1){r=(b!="")?b+" ":"Required."}else{r=(b!="")?b+" ":"Recommended."}for(var s in l){var t=l[s];if(testing){console.log(s+" "+t)}}var j='<div id="msg02_p'+(n+1)+'" class="countscore'+countscore+'" >'+r+" </div></td>";if(testing){console.log("in scoreQuizes objectiveID="+g)}objStatus=(typeof parent.SCOGetObjectiveData(g,"status")!="undefined")?(parent.SCOGetObjectiveData(g,"status")):"not attempted";if(testing){console.log("objStatus= "+objStatus)}objMax=(typeof parent.SCOGetObjectiveData(g,"score.max")!="undefined")?parseInt(parent.SCOGetObjectiveData(g,"score.max"),10):"q.qMax";if(testing){console.log("objMax= "+objMax)}objScore=(typeof parent.SCOGetObjectiveData(g,"score.raw")!="undefined")?parseInt(parent.SCOGetObjectiveData(g,"score.raw"),10):"q.qScore";if(testing){console.log("GXQ typeof objScore="+typeof objScore+" objScore="+objScore)}qMax=(typeof objMax!="undefined")?parseInt(objMax,10):0;qScore=((typeof objMax!="undefined")&&(!isNaN(objScore)))?parseInt(objScore,10):0;if(testing){console.log("GXP typeof q.qScore="+typeof l.qScore+" q.qScore="+l.qScore+"qScore= "+qScore+", qMax"+qMax)}if(testing){console.log("about to list all quizzes in quizFunctions.js");console.log("objStatus= "+objStatus);console.log("q.qStatus= "+l.qStatus);console.log("typeof objStatus= "+typeof objStatus)}if((objStatus=="not attempted")||(l.qStatus=="not attempted")||(typeof objStatus=="undefined")){h+=('<tr><td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt">You have not completed the quiz on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--A--><br/></td></tr>');if(countscore==1){moduleStatus="incomplete"}}else{switch(d){case"Q":if(isNaN(objMax)){if(countscore==1){moduleStatus="incomplete"
}h+=('<tr><td class="unfinQzLft" id="msg01_p'+(n+1)+'"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt"  id="msg03_p'+(n+1)+'">You have not completed the quiz on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--B--><br/></td></tr>')}else{if(((typeof objScore!="undefined")&&(objStatus!="not attempted"))||(objStatus=="completed")){if(typeof countscore=="undefined"||countscore==1||countscore==2){h+=("<tr>");h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>You scored "+qScore+" out of "+objMax+".");h+=(j);h+=('<td class="unfinQzRt"><a href="'+l.url+'" class="tryagainLink">Try again?</a><!--C--><br/></td>');h+=("</tr>")}else{if(countscore==0){h+=("<tr>");h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt"><a href="'+l.url+'" class="tryagainLink">Try again?</a><!--C2--><br/></td>');h+=("</tr>")}}}}break;case"C":if((objStatus=="not attempted")||(l.qStatus=="not attempted")||(typeof objStatus=="undefined")){h+=("<tr>");h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt">You have not completed the quiz on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--D--><br/></td>');h+=("</tr>");if(countscore==1){moduleStatus="incomplete"}}else{if(countscore==1&&isNaN(objMax)){moduleStatus="incomplete";h+=("<tr>");h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt">You have not completed the quiz on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--E--><br></td>');h+=("</tr>")}else{if(((typeof objScore!="undefined")&&(objStatus!="not attempted"))||(objStatus=="completed")){h+=("<tr>");if(!isNaN(objMax)){h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>You scored "+qScore+" out of "+objMax+".")}else{if(isNaN(objMax)){h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>")}}h+=(j);h+=('<td class="unfinQzRt"><a href="'+l.url+'" class="tryagainLink">Try again?</a><!--F--></td>');h+=("</tr>")}}}break;case"I":if((objStatus=="")||(typeof objStatus=="undefined")||(typeof objStatus==undefined)){h+=('<tr><td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt">You have not completed the quiz on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--M--><br/></td></tr>');if(countscore==1){moduleStatus="incomplete"}}if(countscore==0&&l.qStatus=="incomplete"){h+=("<tr>");if(isNaN(objScore)){h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>")}else{h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>You scored "+qScore+" out of "+objMax+".")}h+=(j);h+=('<td class="unfinQzRt"><a href="'+l.url+'" class="tryagainLink">Try again?</a><br/><!--H--><br/></td>');h+=("</tr>")}else{if((countscore==1)&&(objStatus=="incomplete"||l.qStatus=="incomplete")){moduleStatus="incomplete";h+=("<tr>");h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt">You have not finished all the items on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--I--><br/></td>');h+=("</tr>")}else{if((objStatus=="completed"||l.qStatus=="completed")){h+=("<tr>");h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>You scored "+qScore+" out of "+objMax+".<br/>");h+=(j);h+=('<td class="unfinQzRt"><a href="'+l.url+'" class="tryagainLink">Try again?</a><!--J--><br/></td>');h+=("</tr>")}}}break;case"U":if((objMax!="")&&(typeof objMax!="undefined")&&!isNaN(objMax)&&(parseInt(objMax,10)>0)){l.qMax=parseInt(objMax,10)}qMax=l.qMax;if(testing){console.log("moduleStatus="+moduleStatus+" objStatus= |"+objStatus+"|, objScore= |"+objScore+"|, q.qStatus= |"+l.qStatus+"|")}if((objStatus=="")||(typeof objStatus=="undefined")){h+=('<tr><td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>");h+=(j);h+=('<td class="unfinQzRt">You have not completed the quiz on page '+(n+1)+' <a href="'+l.url+'" class="gothereLink">Go there now!</a><!--A--><br/></td></tr>');if(countscore==1){moduleStatus="incomplete"}}if(((typeof objScore!="undefined")&&(objStatus!="not attempted")&&(objStatus!=""))||(objStatus=="completed")){h+=("<tr>");if(!isNaN(objMax)){h+=('<td class="unfinQzLft" width="360"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>You scored "+qScore+" out of "+objMax+".")}else{h+=('<td class="unfinQzLft"><b>'+l.buttonTitle+"</b> on page "+(n+1)+".<br/>")}h+=(j);h+=('<td class="unfinQzRt"><a href="'+l.url+'" class="tryagainLink">Try again?</a><!--L--><br/></span></td>');h+=("</tr>")}break}}if((typeof l.countscore=="undefined")||((typeof l.countscore!="undefined")&&(l.countscore==1))){console.log("quiz: "+g+"===========");console.log("totalmaxRawScore= "+m+" qMax="+qMax);m+=(qMax);console.log("totalRawScore= "+o+" qScore="+qScore);
o+=parseInt(qScore,10)}}}if(moduleStatus!="incomplete"){if(isNaN(a)){parent.SCOSetValue("cmi.core.score.raw",k+"");parent.SCOSetValue("cmi.core.lesson_status","completed");alert('there is no mastery score set in MLearning. Module has been marked "complete" instead of pass/fail.')}else{k=(m!=0?Math.round((o/m)*100):0);parent.SCOSetValue("cmi.core.score.raw",k+"");(a>k)?(parent.SCOSetValue("cmi.core.lesson_status","failed"),moduleStatus="failed"):(parent.SCOSetValue("cmi.core.lesson_status","passed"),moduleStatus="passed");parent.SCOCommit();f.innerHTML+=('<div id="modStatus">This module is<br><span class="moduleStatusMsg">'+moduleStatus+"</span>");f.innerHTML+=(' <div id="finOptions">');f.innerHTML+=('<table><tr valign="top"><td class="StatusPageFdbk" ><div class="finalCompleteButton" onMouseDown="parent.SCOCommit();closingActions();">Send score to<br/>MLearning. Course is<br/>complete.</div></td><td class="StatusPageFdbk"><div class="finalSuspendButton" onmousedown="parent.myStage.suspendActions();">Save progress<br/>achieved so far<br/>and finish later.</div></div></td></tr><tr><td style="padding-top:12px;"></td></tr></table></div>');f.innerHTML+=("<ul><li>You scored <b>"+o+" point(s)</b> out of a possible <b>"+m+'</b>.<br><li>Your total score for this module is <h1 style="display:inline">'+k+"%</h1><br> This module requires <b>"+a+'%</b> to pass. <br/><span style="font-size:10px;font-weight:bold;color:red;">If you wish to improve your score, you may retake any quiz by clicking the button(s) below.</span></li></ul></div>');f.innerHTML+=('<table id="unfinQzTbl">'+h+"</table>");f.innerHTML+=('<div class="CertInstructions"><img src="images/quiz/certificateDiagram.jpg" width="250" id="certDiag"/></div>')}}else{if(moduleStatus=="incomplete"){parent.SCOSetValue("cmi.core.lesson_status","incomplete");f.innerHTML+=('<div id="modStatus">This module is<br><span class="moduleStatusMsg">'+moduleStatus+"</span>");f.innerHTML+=('<div id="unFinOptions" align="center"><h1 class="red" style="font:18px bold Verdana, Arial,Helvetica, sans-serif;">This module can not be marked <span style="color:#000;">Complete</span> until all required quiz pages are completed.</h1><table style="margin-top:6px;"><tr valign="top"><td class="StatusPageFdbk" ><div class="finalSuspendButton" onmousedown="parent.myStage.suspendActions();">Save progress<br/>achieved so far<br/>and finish later.</div></div></td></tr></table></div>');f.innerHTML+=('<table id="unfinQzTbl">'+h+"</table>")}}parent.SCOCommit();turnOffMsg();if(testing){console.log("iMasteryScore= "+a+", moduleStatus= "+moduleStatus);console.log("totalmaxRawScore= "+m+"totalRawScore= "+o+"totalPercentScore= "+k)}f.style.display="block";c.style.display="none"}else{f.innerHTML+=("LMS not detected");f.style.display="block"}}function docentCloseWindow(){if(typeof top.API_extensions!="undefined"){top.window.close()}else{}};